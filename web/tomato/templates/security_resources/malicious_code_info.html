{% extends "base.html" %}
{% load i18n %}

{% load url from future %}

{% block header %}
<script language="JavaScript" type="text/javascript" src="/js/dynimg.js"></script>
{% endblock %}


{% block title %}
<title>Malicious Code '{{ mc_info.name }}' - ProviSec Testbed</title>
{% endblock %}

{% block content %}
{% load tomato %}

<form>
    <button type="submit" formaction="{%url 'malicious_code_list'%}" class="btn btn-primary" style="float:right;">
        <span class="glyphicon glyphicon-list"></span>
        {%trans 'All Malicious Codes'%}
    </button>
</form>

<h1>{%trans 'Malicious Code ''%}{{mc_info.name}}'</h1>

<div class="skip-sm"></div>

<table class="table">
    <tr>
        <th>{%trans 'ID'%}:</th>
        <td>{{ mc_info.id }}</td>
    </tr>
    <tr>
        <th>{%trans 'Name'%}:</th>
        <td>{{ mc_info.name }}</td>
    </tr>
    <tr>
        <th>{%trans 'Type'%}:</th>
        <td>{{ mc_info.type }}</td>
    </tr>
    <tr>
        <th>{%trans 'System'%}:</th>
        <td>{{ mc_info.system }}</td>
    </tr>
    <tr>
        <th>{%trans 'URL'%}:</th>
        <td>{{ mc_info.url }}</td>
    </tr>
    <tr>
        <th>{%trans 'Description'%}:</th>
        <td>{{ mc_info.description }}</td>
    </tr>
    <tr>
        <th>{%trans 'Creation Date'%}:</th>
        <td>{{ mc_info.creation_date|todate }}</td>
    </tr>
</table>

<div class="skip-sm"></div>

{% load tomato %}

{% if request.session.user.isGlobalHostManager %}
<form>
    <button type="submit" formaction="{%url 'malicious_code_edit' mc_info.id%}" class="btn btn-warning">
        <span class="glyphicon glyphicon-pencil"></span>
        {%trans 'edit malicious code'%}
    </button>
    <button type="submit" formaction="{%url 'malicious_code_remove' mc_info.id%}" class="btn btn-danger">
        <span class="glyphicon glyphicon-trash"></span>
        {%trans 'remove malicious code'%}
    </button>
</form>
{%endif%}

{% endblock %}